# 项目长期记忆

## 项目概述
*更新于: 2026-02-06 16:40*

Mnemos 是一个为 AI Agent 提供持久记忆的工具。它能够通过 Git 历史自动生成短期记忆，并帮助管理结构化的长期记忆。

最近新增了 `mnemos init --only-skills` 选项，允许用户在不影响 `.memory` 目录下现有记忆文件的情况下，单独更新 `.agent/skills` 目录中的 Skill 模板文件。

## 架构决策
<!-- 重要的架构选择及其理由 -->

## 代码风格与约定
<!-- 团队/个人的编码偏好和规范 -->


### 最佳实践更新：AI Agent 记忆写入流程
为了彻底消除 Shell 对 Markdown（尤其是反引号）的解析风险，已在 Skill 模板中明确了 **AI Agent 推荐流程**：
1. **创建临时文件**：利用 `write_file` 创建纯净的 `.md` 内容。
2. **文件读取写入**：使用 `mnemos write -f <file>` 绕过命令行字符串传递。
3. **清理与同步**：删除临时文件并执行 `mnemos update`。

此流程已被记录为 Mnemos 系统的标准操作规范。

*追加于: 2026-02-06 16:52*

## 技术选型
<!-- 使用的关键技术栈及选择理由 -->

## 重要约束与注意事项
*追加于: 2026-02-06 16:45*

1. **安全写入**：在命令行更新记忆时，强烈建议使用 `stdin` 方式（如 `echo "content" | mnemos write -c -`），以避免反引号等 Markdown 符号被 Shell 误解析为命令执行。
2. **Skill 更新**：使用 `mnemos init --only-skills` 可以仅同步 Skill 定义，而不破坏已有的 `.memory` 记忆文件。
### 功能增强：安全写入与 Skill 维护
1. **-f/--file 参数**：支持从外部文件读取内容。通过 `mnemos write -f <file>` 写入，内容完全不经过 Shell 解析，解决了反引号等 Markdown 符号导致的执行风险。
2. **--only-skills 选项**：支持仅更新 `.agent/skills` 目录，保护 `.memory` 目录下的用户记忆不被覆盖。
3. **安全确认**：在替换长期记忆时增加了交互式确认。

*追加于: 2026-02-06 16:50*

